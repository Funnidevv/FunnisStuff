<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Settings - PC Sandbox</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet" />
  <style>
    /* Reset */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #0f1117 0%, #181c27 100%);
      color: #d0d4ff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background 0.5s ease, color 0.5s ease;
    }
    a {
      color: #8ba0ff;
      text-decoration: none;
      transition: color 0.3s ease;
    }
    a:hover, a:focus {
      color: #5a70ff;
      text-decoration: underline;
      outline: none;
    }

    header {
      background: #1c2031;
      box-shadow: 0 0 20px #5a70ff88;
      padding: 1rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.5s ease, box-shadow 0.5s ease;
    }
    .logo {
      font-weight: 700;
      font-size: 1.8rem;
      color: #7c8bff;
      text-shadow: 0 0 12px #7c8bff;
      user-select: none;
      transition: color 0.5s ease, text-shadow 0.5s ease;
    }

    nav a {
      font-weight: 600;
      font-size: 1rem;
      margin-left: 1.5rem;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      box-shadow: 0 0 12px transparent;
      user-select: none;
      transition: background 0.3s ease, box-shadow 0.3s ease, color 0.3s ease;
    }
    nav a.active, nav a:focus {
      background: #5a70ff;
      box-shadow: 0 0 12px #5a70ff;
      color: #fff;
      outline: none;
    }

    main {
      flex-grow: 1;
      max-width: 720px;
      margin: 4rem auto 6rem;
      padding: 0 1rem;
      user-select: none;
      transition: color 0.5s ease;
    }

    main h1 {
      font-weight: 700;
      font-size: 2.8rem;
      margin-bottom: 1.5rem;
      color: #7c8bff;
      text-shadow: 0 0 15px #7c8bff;
      transition: color 0.5s ease, text-shadow 0.5s ease;
    }
    label {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      display: block;
      color: #abb2ffcc;
      transition: color 0.5s ease;
      cursor: pointer;
    }
    input[type="checkbox"] {
      transform: scale(1.3);
      margin-right: 10px;
      cursor: pointer;
      vertical-align: middle;
    }
    input[type="text"], input[type="password"], select {
      width: 100%;
      padding: 10px 14px;
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      background: #1c2031;
      color: #d0d4ff;
      box-shadow: inset 0 0 10px #5a70ff44;
      margin-bottom: 20px;
      transition: box-shadow 0.3s ease, background 0.5s ease, color 0.5s ease;
      font-weight: 600;
      font-family: 'Poppins', sans-serif;
      user-select: text;
    }
    input[type="text"]:focus, input[type="password"]:focus, select:focus {
      box-shadow: 0 0 12px #5a70ffcc;
      outline: none;
      background: #272c4a;
    }

    button {
      background: #5a70ff;
      border: none;
      padding: 14px 24px;
      color: white;
      font-weight: 700;
      font-size: 1.1rem;
      border-radius: 14px;
      cursor: pointer;
      box-shadow: 0 6px 20px #5a70ff88;
      transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
      user-select: none;
      display: inline-block;
      margin-top: 10px;
    }
    button:hover {
      background: #3e50ff;
      box-shadow: 0 8px 30px #3e50ffbb;
      transform: scale(1.07);
    }

    .section {
      margin-bottom: 3rem;
    }
    .section h2 {
      font-weight: 700;
      font-size: 1.8rem;
      margin-bottom: 1.2rem;
      color: #7c8bff;
      text-shadow: 0 0 12px #7c8bff;
      transition: color 0.5s ease, text-shadow 0.5s ease;
    }

    .beta-tester {
      margin-top: 1rem;
    }

    .tester-tab {
      background: #1c2031;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 0 20px #5a70ff66;
      margin-top: 1rem;
      color: #d0d4ff;
      display: none;
      user-select: text;
      transition: background 0.5s ease, color 0.5s ease, box-shadow 0.5s ease;
    }
    .tester-tab.active {
      display: block;
    }

    /* Language selector styling */
    .lang-select-container {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #abb2ffcc;
      font-weight: 500;
      font-size: 0.95rem;
      user-select: none;
    }
    select#languageSelect {
      background: #2a2f48;
      border: none;
      border-radius: 6px;
      color: #abb2ff;
      padding: 0.3rem 0.7rem;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s ease, color 0.3s ease;
      user-select: none;
    }
    select#languageSelect:hover, select#languageSelect:focus {
      background: #3e50ff;
      color: white;
      outline: none;
    }

    /* New Beta Tester Settings GUI */
    #betaTesterSettings {
      background: #1c2031;
      padding: 1.5rem 1.5rem 2rem 1.5rem;
      border-radius: 14px;
      box-shadow: 0 0 25px #5a70ffbb;
      margin-top: 2rem;
      color: #d0d4ff;
      user-select: text;
      display: none;
    }
    #betaTesterSettings h3 {
      color: #7c8bff;
      margin-bottom: 1rem;
      font-weight: 700;
      font-size: 1.6rem;
      text-shadow: 0 0 12px #7c8bff;
    }
    #betaTesterSettings p {
      margin-bottom: 1.2rem;
      color: #abb2ffcc;
      font-weight: 600;
      font-size: 1.05rem;
      line-height: 1.4;
    }
    #betaTesterSettings ul {
      margin-left: 1.4rem;
      margin-bottom: 1.5rem;
      color: #abb2ffcc;
      font-weight: 600;
      font-size: 1.05rem;
      list-style: disc;
    }
    #betaTesterSettings ul li {
      margin-bottom: 0.6rem;
    }
    #betaTesterSettings a#betaDownloadBtn {
      display: inline-block;
      background: #5a70ff;
      padding: 14px 32px;
      border-radius: 18px;
      color: white;
      font-weight: 700;
      font-size: 1.15rem;
      box-shadow: 0 6px 20px #5a70ff88;
      user-select: none;
      text-decoration: none;
      transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;
    }
    #betaTesterSettings a#betaDownloadBtn:hover {
      background: #3e50ff;
      box-shadow: 0 8px 30px #3e50ffbb;
      transform: scale(1.05);
      text-decoration: none;
    }

    /* Background modes CSS */

    body.mode_none {
      background: #0f1117;
      color: #d0d4ff;
      transition: background 0.5s ease;
    }
    body.mode_neon {
      background: radial-gradient(circle at center, #080c18, #00104d 80%);
      color: #7c8bff;
      text-shadow:
        0 0 5px #8a93ff,
        0 0 10px #8a93ff,
        0 0 20px #5a70ff,
        0 0 30px #3e50ff;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.mode_dark {
      background: linear-gradient(135deg, #14191f 0%, #22292f 100%);
      color: #a3b1ffcc;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.mode_starfield {
      background: black;
      overflow: hidden;
      color: #b0b7ff;
      transition: background 0.5s ease, color 0.5s ease;
    }
    /* Starfield canvas covers entire screen */
    #starfield-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 0;
    }
    body.mode_lines {
      background: linear-gradient(45deg, #1c2031 25%, transparent 25%), 
                  linear-gradient(-45deg, #1c2031 25%, transparent 25%), 
                  linear-gradient(45deg, transparent 75%, #1c2031 75%), 
                  linear-gradient(-45deg, transparent 75%, #1c2031 75%);
      background-size: 40px 40px;
      background-position: 0 0, 0 20px, 20px -20px, -20px 0px;
      color: #a2aaffcc;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.mode_grid {
      background:
        linear-gradient(to right, #1c2031 1px, transparent 1px),
        linear-gradient(to bottom, #1c2031 1px, transparent 1px);
      background-size: 40px 40px;
      color: #a0a7ffcc;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.mode_blue {
      background: linear-gradient(135deg, #001830 0%, #00336b 100%);
      color: #a9c4ff;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.mode_magenta {
      background: linear-gradient(135deg, #330030 0%, #770059 100%);
      color: #ff9ddb;
      transition: background 0.5s ease, color 0.5s ease;
    }
    body.mode_magenta_blue {
      background: linear-gradient(135deg, #330030 0%, #770059 50%, #003366 100%);
      color: #d28fff;
      transition: background 0.5s ease, color 0.5s ease;
    }

  </style>
</head>
<body>
  <header>
    <a href="index.html" class="logo" tabindex="1" aria-label="Go to Home page">PC Sandbox</a>
    <nav aria-label="Main navigation">
      <a href="settings.html" class="active" tabindex="2" aria-current="page">Settings</a>
      <a href="about.html" tabindex="3">About</a>
      <a href="help.html" tabindex="4">Help</a>
      <a href="mods.html" tabindex="5">Mods</a>
      <div class="lang-select-container" aria-label="Select language">
        <label for="languageSelect" class="visually-hidden">Language</label>
        <select id="languageSelect" aria-live="polite" aria-atomic="true" aria-relevant="all" tabindex="6">
          <option value="en" selected>English</option>
          <option value="ru">Русский</option>
          <option value="es">Español</option>
          <option value="zh">中文</option>
          <option value="fr">Français</option>
          <option value="ja">日本語</option>
          <option value="de">Deutsch</option>
          <option value="it">Italiano</option>
          <option value="pt">Português</option>
          <option value="ko">한국어</option>
          <option value="pl">Polski</option>
          <option value="tr">Türkçe</option>
        </select>
      </div>
    </nav>
  </header>

  <main role="main">
    <h1>Settings</h1>

    <section class="section" aria-labelledby="backgroundLabel">
      <h2 id="backgroundLabel">Background Color Mode</h2>
      <label for="bgModeSelect">Select background mode:</label>
      <select id="bgModeSelect" aria-describedby="bgHelp">
        <option value="none">None</option>
        <option value="neon">Neon</option>
        <option value="dark">Dark</option>
        <option value="starfield">Starfield</option>
        <option value="lines">Lines</option>
        <option value="grid">Grid</option>
        <option value="blue">Blue</option>
        <option value="magenta">Magenta</option>
        <option value="magenta_blue">Magenta-Blue</option>
      </select>
      <div id="bgHelp" style="font-size: 0.9rem; margin-top: 6px; color: #abb2ffcc;">
        Choose the style of the background you want for the site.
      </div>
    </section>

    <section class="section" aria-labelledby="languageLabel">
      <h2 id="languageLabel">Language</h2>
      <p>Use the dropdown in the header to select your preferred language.</p>
    </section>

    <section class="section beta-tester" aria-labelledby="betaTesterLabel">
      <h2 id="betaTesterLabel">Beta Tester Settings</h2>
      <label>
        <input type="checkbox" id="enableBetaTester" aria-checked="false" />
        Enable Beta Tester Settings
      </label>

      <div id="betaTesterSettings" role="region" aria-live="polite" aria-atomic="true">
        <h3>Beta Tester Build</h3>
        <p>
          This build includes many improvements and fixes:
        </p>
        <ul>
          <li>Custom level teleport system</li>
          <li>Smooth motion enhancements</li>
          <li>Optimized VR locomotion</li>
          <li>Additional color modes and themes</li>
          <li>And much more...</li>
        </ul>
        <a href="pc_sandbox_beta.zip" id="betaDownloadBtn" role="button" tabindex="0" aria-label="Download Beta Tester Build">Download Beta Tester Build</a>
      </div>
    </section>
  </main>

  <canvas id="starfield-canvas" aria-hidden="true"></canvas>

  <script>
    // Manage Language Select persistence
    const languageSelect = document.getElementById('languageSelect');
    // Load language from localStorage if available
    const savedLang = localStorage.getItem('pcSandboxLanguage');
    if (savedLang) {
      languageSelect.value = savedLang;
    }
    languageSelect.addEventListener('change', () => {
      localStorage.setItem('pcSandboxLanguage', languageSelect.value);
      // Here you would add code to change language dynamically or reload page
    });

    // Beta Tester Settings toggle
    const enableBetaCheckbox = document.getElementById('enableBetaTester');
    const betaSettingsDiv = document.getElementById('betaTesterSettings');

    // Load Beta Tester enabled state from localStorage
    const betaEnabledSaved = localStorage.getItem('pcSandboxBetaEnabled') === 'true';
    enableBetaCheckbox.checked = betaEnabledSaved;
    betaSettingsDiv.style.display = betaEnabledSaved ? 'block' : 'none';
    enableBetaCheckbox.setAttribute('aria-checked', betaEnabledSaved);

    enableBetaCheckbox.addEventListener('change', () => {
      const enabled = enableBetaCheckbox.checked;
      localStorage.setItem('pcSandboxBetaEnabled', enabled);
      betaSettingsDiv.style.display = enabled ? 'block' : 'none';
      enableBetaCheckbox.setAttribute('aria-checked', enabled);
    });

    // Background Color Mode Select
    const bgModeSelect = document.getElementById('bgModeSelect');
    const starfieldCanvas = document.getElementById('starfield-canvas');
    const ctx = starfieldCanvas.getContext('2d');

    // Starfield effect variables
    let stars = [];
    const numStars = 150;
    let animationFrameId;

    function resizeCanvas() {
      starfieldCanvas.width = window.innerWidth;
      starfieldCanvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);

    // Initialize starfield stars
    function initStars() {
      stars = [];
      for (let i = 0; i < numStars; i++) {
        stars.push({
          x: Math.random() * starfieldCanvas.width,
          y: Math.random() * starfieldCanvas.height,
          z: Math.random() * starfieldCanvas.width,
        });
      }
    }

    function animateStarfield() {
      const width = starfieldCanvas.width;
      const height = starfieldCanvas.height;
      ctx.clearRect(0, 0, width, height);
      ctx.fillStyle = 'white';

      for (let i = 0; i < stars.length; i++) {
        let star = stars[i];

        star.z -= 2;
        if (star.z <= 0) {
          star.x = Math.random() * width;
          star.y = Math.random() * height;
          star.z = width;
        }

        const sx = (star.x - width / 2) * (width / star.z) + width / 2;
        const sy = (star.y - height / 2) * (width / star.z) + height / 2;

        if (sx < 0 || sx >= width || sy < 0 || sy >= height) continue;

        const size = (1 - star.z / width) * 2;
        ctx.beginPath();
        ctx.arc(sx, sy, size, 0, 2 * Math.PI);
        ctx.fill();
      }
      animationFrameId = requestAnimationFrame(animateStarfield);
    }

    // Start starfield animation
    function startStarfield() {
      resizeCanvas();
      initStars();
      animateStarfield();
      starfieldCanvas.style.display = 'block';
    }

    // Stop starfield animation
    function stopStarfield() {
      cancelAnimationFrame(animationFrameId);
      starfieldCanvas.style.display = 'none';
      ctx.clearRect(0, 0, starfieldCanvas.width, starfieldCanvas.height);
    }

    function applyBackgroundMode(mode) {
      // Remove all mode- classes from body
      document.body.className = '';
      if (mode && mode !== 'none') {
        document.body.classList.add('mode_' + mode);
      }

      // Starfield needs canvas animation
      if (mode === 'starfield') {
        startStarfield();
      } else {
        stopStarfield();
      }
    }

    // Load saved background mode from localStorage or default
    let savedBgMode = localStorage.getItem('pcSandboxBackgroundMode') || 'none';
    bgModeSelect.value = savedBgMode;
    applyBackgroundMode(savedBgMode);

    bgModeSelect.addEventListener('change', () => {
      const mode = bgModeSelect.value;
      localStorage.setItem('pcSandboxBackgroundMode', mode);
      applyBackgroundMode(mode);
    });

    // Accessibility: add a visually-hidden class for labels if needed
    const style = document.createElement('style');
    style.textContent = `.visually-hidden { 
      position: absolute !important; 
      height: 1px; width: 1px; 
      overflow: hidden; 
      clip: rect(1px,1px,1px,1px); 
      white-space: nowrap; 
    }`;
    document.head.appendChild(style);
  </script>
</body>
</html>
